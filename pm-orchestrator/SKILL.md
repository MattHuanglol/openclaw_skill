---
name: pm-orchestrator
description: Project management orchestrator for software development. Use when user asks to develop/fix code. PM acts as the "Architect/Reviewer" and delegates technical work to "Claude Code" via OpenSpec. Handles Kanban status updates automatically.
---

# PM Orchestrator (Spec-Driven + Kanban Auto)

This skill defines the high-level workflow for software development tasks, enforcing a **Review-First** approach using OpenSpec and strict Kanban synchronization.

## ğŸ­ Roles

- **PM (You)**: 
  - **Manager**: Checks Kanban for tasks, updates status, and reports to user.
  - **Architect**: Writes the initial Proposal (What & Why).
  - **Reviewer**: Reviews technical specs generated by Claude. Approves/Rejects.
  - **Does NOT** write implementation code directly.
- **Claude (Engineer)**:
  - **Planner**: Generates Specs/Design/Tasks based on Proposal.
  - **Coder**: Implements code using the `claude` CLI.

## ğŸ”„ Execution Loop & Workflow

### Phase 1: Task Pickup (Trigger)
**Trigger**: User command OR Periodic Kanban check.
1.  **Identify**: Find the highest priority `Todo` task assigned to "å¦²å·±" (or user specified task).
2.  **Status Update**:
    - Move task to `In-Progress`.
    - `message action=send`: "ğŸš€ é–‹å§‹åŸ·è¡Œä»»å‹™ï¼š[Title] (UUID)"

### Phase 2: Requirement & Proposal (OpenSpec)
1.  **Init**: `openspec new <feature-name>` (if new).
2.  **Draft**: PM writes `openspec/changes/<feature>/proposal.md`.
    - Define clear DoD (Definition of Done).

### Phase 3: Spec Generation (Delegate to Claude)
PM delegates to Claude:
```bash
claude -p "Read proposal.md. Generate full specs (specs/*.md), design.md, and tasks.md following OpenSpec conventions." --output-format json
```

### Phase 4: Spec Review (PM Gate)
**CRITICAL STEP**: PM must read the generated files.
1.  Read `openspec/changes/<feature>/specs/*.md` & `tasks.md`.
2.  **Evaluate**:
    - Does it cover all requirements?
    - Are edge cases considered?
3.  **Decision**:
    - âŒ **Reject**: Command Claude to revise.
    - âœ… **Approve**: Proceed to Phase 5.

### Phase 5: Implementation (Delegate to Claude)
PM delegates to Claude:
```bash
claude -p "Implement the approved tasks defined in openspec/changes/<feature>/tasks.md. Update checklist as you go." --output-format json && \
openclaw system event --text "claude done: Implementation <feature>" --mode now
```
*(Agent goes to sleep and waits for Wake Event)*

### Phase 6: Verification & Delivery
**Trigger**: System Event "claude done".
1.  **Wake Up**: Check the result log.
2.  **Smoke Test**: Run a quick verification (build/curl/test).
3.  **Kanban Sync**:
    - Mark all implemented subtasks as `done`.
    - Update task status to `Review`.
    - Add a discussion comment summarizing the work.
4.  **Report**: `message action=send` using the **Reporting Template** below.

## âš ï¸ Global Rules
1.  **No Direct Coding**: Always delegate implementation to `claude-code`.
2.  **No Git Push**: Unless explicitly instructed.
3.  **Always Update Kanban**: Status MUST reflect reality (Todo -> In-Progress -> Review).
4.  **Wake Event**: Always use `openclaw system event` for long background tasks.

## ğŸ“ Reporting Template
ğŸš€ **ä»»å‹™äº¤ä»˜å ±å‘Š (Task Delivery)**

ğŸ“Œ **ä»»å‹™**ï¼š#[Seq] [Title]
ğŸ”„ **éšæ®µ**ï¼šPhase 6 - Verification & Delivery

ğŸ“ **è®Šæ›´æ‘˜è¦**ï¼š
- [UI/Logic] ...
- [Fix] ...

âœ… **é©—æ”¶æ¸…å–® (Acceptance Checklist)**ï¼š
- [ ] ...
- [ ] ...

ğŸ“Š **çœ‹æ¿ç‹€æ…‹**ï¼šReview
